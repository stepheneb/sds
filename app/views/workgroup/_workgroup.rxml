xm.entry 'xml:base' => url_for(:controller => 'offering', :action => 'list', :only_path => false).to_s do
  member_names = members.collect {|m| m.name}.join(', ')
  xm.author do
    xm.name member_names
  end
  xm.id        "tag:#{request.host_with_port},#{workgroup.updated_at.to_s}:#{workgroup.id}"
  xm.published workgroup.created_at.xmlschema
  xm.updated   workgroup.updated_at.xmlschema
  xm.link "rel" => "alternate", "type" => "text/html", 
    "href" => url_for(:controller => 'workgroup', :action => 'show', :id => workgroup.id, :only_path => false).to_s
  xm.title     strip_tags(workgroup.name)
  
  xm << %{<content type="html">\n}
  xm << h(%{<p>Workgroup: "#{workgroup.name}", <em>(id: #{workgroup.id})</em><br />
    Member: #{member_names}, <em>(ids: #{members.collect {|m| m.id}.join(', ')})</em>. <br />
    Offering: "#{workgroup.offering.name}", <em>(id: #{workgroup.offering.id})</em><br />
    Curnit: "#{workgroup.offering.curnit.name}" <em>(id: #{workgroup.offering.curnit.id}), last updated: #{workgroup.offering.curnit.get_curnit_last_modified}</em>.})
  workgroup.bundles.each do |b| 
    xm << h(%{<hr /><div style="background-color: #BBFFEE; padding: 10px; border: 1px solid grey; margin: 10px; font: 9px sans-serif;">})
    xm << h(%{Bundle: #{b.id}, #{b.created_at.to_s}, Workgroup membership version: #{b.workgroup_version.to_s}.<br />})
    b.socks.each do |s|
      xm << h(%{Pod UUID: #{s.pod.uuid}, Rim name: #{s.pod.rim_name}, Sock id: #{s.id}, ms offset: #{s.ms_offset}.<br />})
      xm << h(%{<div style="background-color: #99FFCC; padding: 10px; border: 1px dotted grey; margin: 10px 10px 5px 5px; font: sans-serif;">})
      xm << CGI.escapeHTML("<pre>#{CGI.escapeHTML(CGI.unescapeHTML(s.value))}</pre>")
      xm << h(%{</div>})
    end
    xm << h(%{</div>})
  end
  xm << %{</content>}
end
